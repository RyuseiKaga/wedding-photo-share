<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

  <title>Wedding Photo Share</title>

  <link
    rel="icon"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3E%F0%9F%93%B7%3C/text%3E%3C/svg%3E"
  />

  <!-- Cloudinary 早くする（接続の先張り） -->
  <link rel="preconnect" href="https://res.cloudinary.com" crossorigin>

  <link rel="stylesheet" href="css/style.css?v=67" />
</head>
<body>

  <header class="header">
    <h1>📸 写真をシェアしよう</h1>
    <p>タップで高画質表示 / チェックで選択 → 一括保存</p>
  </header>

  <main>
    <section class="upload">
      <label class="upload-button">
        写真をアップロード
        <input id="fileInput" type="file" accept="image/*" multiple hidden />
      </label>
    </section>

    <section class="gallery" id="gallery"></section>
  </main>

  <!-- 下固定バー（選択/一括保存） -->
  <div id="bulkBar" class="bulkbar" hidden>
    <div class="bulkbar-left">
      <div class="bulkbar-count">
        選択: <span id="selectedCount">0</span> 枚
      </div>
      <button id="clearSelection" class="bulkbar-link" type="button">選択解除</button>
    </div>

    <div class="bulkbar-right">
      <button id="bulkSave" class="bulkbar-btn primary" type="button">
        一括保存（カメラロール）
      </button>
    </div>
  </div>

  <!-- 全画面オーバーレイ（初回ロード / アップロード / 一括保存準備） -->
  <div id="uploadOverlay" class="overlay" hidden>
    <div class="overlay-card" role="status" aria-live="polite">
      <div class="spinner" aria-hidden="true"></div>
      <div class="spinner-pulse" aria-hidden="true"></div>

      <!-- JSは .overlay-title を拾えるので id は不要（あってもOK） -->
      <div class="overlay-title">処理中…</div>
      <div id="uploadOverlaySub" class="overlay-sub">しばらくお待ちください</div>
      <div id="uploadOverlayProgress" class="overlay-progress"></div>
    </div>
  </div>

  <!-- 高画質ビューア -->
  <div id="viewer" class="viewer" hidden>
    <div class="viewer-backdrop" aria-hidden="true"></div>

    <div class="viewer-sheet" role="dialog" aria-modal="true">
      <button id="viewerClose" class="viewer-close" type="button" aria-label="閉じる">✕</button>

      <div class="viewer-media">
        <img id="viewerImg" alt="preview" />
        <div id="viewerLoading" class="viewer-loading" hidden>
          <div class="spinner small" aria-hidden="true"></div>
          <div class="viewer-loading-text">高画質を読み込み中…</div>
        </div>
      </div>

      <div class="viewer-actions">
        <a id="viewerOpen" class="viewer-btn primary" target="_blank" rel="noopener">
          原寸で開く（保存）
        </a>
        <button id="viewerCopy" class="viewer-btn" type="button">
          URLコピー
        </button>
      </div>

      <div class="viewer-note">
        iPhone：<b>「原寸で開く」→ 画像を長押し → “写真に追加/画像を保存”</b> が確実です。
      </div>
    </div>
  </div>

  <script src="js/main.js?v=67"></script>
</body>
</html>
